(this.webpackJsonpapollo=this.webpackJsonpapollo||[]).push([[0],{169:function(t,e,n){"use strict";n.r(e);var a=n(0),i=n.n(a),r=n(18),c=n.n(r),o=n(26),s=n(205),l=n(208),u=n(209),d=n(124),j=n(210),b=n(5),p=Object(s.a)((function(t){return{title:{marginLeft:t.spacing(2)}}}));var O,h,g=function(){var t=p();return Object(b.jsx)(l.a,{color:"primary",position:"fixed",children:Object(b.jsxs)(u.a,{children:[Object(b.jsx)(j.a,{}),Object(b.jsx)(d.a,{className:t.title,variant:"h6",component:"h1",children:"Apollo Music Share"})]})})},m=n(68),x=n.n(m),f=n(95),v=n(78),y=n(27),S=n(243),w=n(211),N=n(212),C=n(238),I=n(213),k=n(214),q=n(215),P=n(216),_=n(217),E=n(79),A=n.n(E),F=n(93),T=n.n(F),G=n(92),Q=n.n(G),$=n(237),R=n(42),D=n(239),L=Object(D.a)(O||(O=Object(R.a)(["\n\tmutation addOrRemoveFromQueue($input: SongInput!) {\n\t\taddOrRemoveFromQueue(input: $input) @client\n\t}\n"]))),J=Object(D.a)(h||(h=Object(R.a)(["\n\tmutation addSong($title: String!, $artist: String!, $thumbnail: String!, $duration: Float!, $url: String!) {\n\t\tinsert_songs(\n\t\t\tobjects: { title: $title, thumbnail: $thumbnail, duration: $duration, url: $url, artist: $artist }\n\t\t) {\n\t\t\taffected_rows\n\t\t}\n\t}\n"]))),M=Object(s.a)((function(t){return{container:{display:"flex",alignItems:"center"},urlInput:{margin:t.spacing(1)},addSongButton:{margin:t.spacing(1)},dialog:{textAlign:"center"},thumbnail:{width:"90%"}}})),U={duration:0,title:"",artist:"",thumbnail:""};var B,W=function(){var t=M(),e=Object($.a)(J),n=Object(o.a)(e,2),a=n[0],r=n[1].error,c=i.a.useState(""),s=Object(o.a)(c,2),l=s[0],u=s[1],d=i.a.useState(!1),j=Object(o.a)(d,2),p=j[0],O=j[1],h=i.a.useState(!1),g=Object(o.a)(h,2),m=g[0],E=g[1],F=i.a.useState(U),G=Object(o.a)(F,2),R=G[0],D=G[1];function L(t){var e=t.target,n=e.name,a=e.value;D((function(t){return Object(y.a)(Object(y.a)({},t),{},Object(v.a)({},n,a))}))}function B(){E(!1)}function W(){return(W=Object(f.a)(x.a.mark((function t(e){var n,a,i;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.player,!(a=n.player.player).getVideoData){t.next=6;break}i=z(a),t.next=10;break;case 6:if(!a.getCurrentSound){t.next=10;break}return t.next=9,K(a);case 9:i=t.sent;case 10:D(Object(y.a)(Object(y.a)({},i),{},{url:l}));case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Y(){return(Y=Object(f.a)(x.a.mark((function t(){var e,n,i,r,c;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=R.url,n=R.thumbnail,i=R.duration,r=R.title,c=R.artist,t.next=4,a({variables:{url:e.length>0?e:null,thumbnail:n.length>0?n:null,duration:i>0?i:null,title:r.length>0?r:null,artist:c.length>0?c:null}});case 4:B(),D(U),u(""),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error("Error adding song",t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))).apply(this,arguments)}function z(t){var e=t.getDuration(),n=t.getVideoData(),a=n.title,i=n.video_id;return{duration:e,title:a,artist:n.author,thumbnail:"http://img.youtube.com/vi/".concat(i,"/0.jpg")}}function K(t){return new Promise((function(e){t.getCurrentSound((function(t){t&&e({duration:Number(t.duration/1e3),title:t.title,artist:t.user.username,thumbnail:t.artwork_url.replace("-large","-t500x500")})}))}))}function V(t){var e,n;return null===r||void 0===r||null===(e=r.graphQLErrors[0])||void 0===e||null===(n=e.extensions)||void 0===n?void 0:n.path.includes(t)}i.a.useEffect((function(){var t=T.a.canPlay(l)||Q.a.canPlay(l);O(t)}),[l]);var H=R.thumbnail,X=R.title,Z=R.artist;return Object(b.jsxs)("div",{className:t.container,children:[Object(b.jsxs)(S.a,{className:t.dialog,open:m,onClose:B,children:[Object(b.jsx)(w.a,{children:"Edit Song"}),Object(b.jsxs)(N.a,{children:[Object(b.jsx)("img",{src:H,alt:"Song thumbnail",className:t.thumbnail}),Object(b.jsx)(C.a,{value:X,onChange:L,margin:"dense",name:"title",label:"Title",fullWidth:!0,error:V("title"),helperText:V("title")&&"Fill out field"}),Object(b.jsx)(C.a,{value:Z,onChange:L,margin:"dense",name:"artist",label:"Artist",fullWidth:!0,error:V("artist"),helperText:V("artist")&&"Fill out field"}),Object(b.jsx)(C.a,{value:H,onChange:L,margin:"dense",name:"thumbnail",label:"Thumbnail",fullWidth:!0,error:V("thumbnail"),helperText:V("thumbnail")&&"Fill out field"})]}),Object(b.jsxs)(I.a,{children:[Object(b.jsx)(k.a,{onClick:B,color:"secondary",children:"Cancel"}),Object(b.jsx)(k.a,{onClick:function(){return Y.apply(this,arguments)},variant:"outlined",color:"primary",children:"Add Song"})]})]}),Object(b.jsx)(C.a,{className:t.urlInput,onChange:function(t){return u(t.target.value)},value:l,placeholder:"Add Youtube or Soundcloud Url",fullWidth:!0,margin:"normal",type:"url",InputProps:{startAdornment:Object(b.jsx)(q.a,{position:"start",children:Object(b.jsx)(P.a,{})})}}),Object(b.jsx)(k.a,{disabled:!p,className:t.addSongButton,onClick:function(){return E(!0)},variant:"contained",color:"primary",endIcon:Object(b.jsx)(_.a,{}),children:"Add"}),Object(b.jsx)(A.a,{url:l,hidden:!0,onReady:function(t){return W.apply(this,arguments)}})]})},Y=n(218),z=n(219),K=n(220),V=n(221),H=n(222),X=n(223),Z=n(224),tt=n(225),et=n(226),nt=n(247),at=Object(D.a)(B||(B=Object(R.a)(["\n\tsubscription getSongs {\n\t\tsongs(order_by: { created_at: desc }) {\n\t\t\tartist\n\t\t\tduration\n\t\t\tid\n\t\t\tthumbnail\n\t\t\ttitle\n\t\t\turl\n\t\t}\n\t}\n"])));var it=Object(s.a)((function(t){return{container:{margin:t.spacing(3)},songInfoContainer:{display:"flex",alignItems:"center"},songInfo:{width:"100%",display:"flex",justifyContent:"space-between"},thumbnail:{objectFit:"cover",width:140,height:140}}}));function rt(t){var e=t.song,n=e.id,a=it(),r=Object($.a)(L,{onCompleted:function(t){localStorage.setItem("queue",JSON.stringify(t.addOrRemoveFromQueue))}}),c=Object(o.a)(r,1)[0],s=i.a.useContext(wt),l=s.state,u=s.dispatch,j=i.a.useState(!1),p=Object(o.a)(j,2),O=p[0],h=p[1],g=e.title,m=e.artist,x=e.thumbnail;return i.a.useEffect((function(){var t=l.isPlaying&&n===l.song.id;h(t)}),[n,l.song.id,l.isPlaying]),Object(b.jsx)(z.a,{className:a.container,children:Object(b.jsxs)("div",{className:a.songInfoContainer,children:[Object(b.jsx)(K.a,{image:x,className:a.thumbnail}),Object(b.jsxs)("div",{className:a.songInfo,children:[Object(b.jsxs)(V.a,{children:[Object(b.jsx)(d.a,{gutterBottom:!0,variant:"h5",component:"h2",children:g}),Object(b.jsx)(d.a,{variant:"body1",component:"p",color:"textSecondary",children:m})]}),Object(b.jsxs)(H.a,{children:[Object(b.jsx)(X.a,{onClick:function(){u({type:"SET_SONG",payload:{song:e}}),u(l.isPlaying?{type:"PAUSE_SONG"}:{type:"PLAY_SONG"})},size:"small",color:"primary",children:O?Object(b.jsx)(Z.a,{}):Object(b.jsx)(tt.a,{})}),Object(b.jsx)(X.a,{onClick:function(){c({variables:{input:Object(y.a)(Object(y.a)({},e),{},{__typename:"Song"})}})},size:"small",color:"secondary",children:Object(b.jsx)(et.a,{})})]})]})]})})}var ct=function(){var t=Object(nt.a)(at),e=t.data,n=t.loading,a=t.error;return n?Object(b.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginTop:50},children:Object(b.jsx)(Y.a,{})}):a?Object(b.jsx)("div",{children:"Error fetching songs"}):Object(b.jsx)("div",{children:e.songs.map((function(t){return Object(b.jsx)(rt,{song:t},t.id)}))})},ot=n(227),st=n(244),lt=n(228);var ut=Object(s.a)({avatar:{width:44,height:44},text:{textOverflow:"ellipsis",overflow:"hidden"},container:{display:"grid",gridAutoFlow:"column",gridTemplateColumns:"50px auto 50px",gridGap:12,alignItems:"center",marginTop:10},songInfoContainer:{overflow:"hidden",whiteSpace:"nowrap"}});function dt(t){var e=t.song,n=ut(),a=Object($.a)(L,{onCompleted:function(t){localStorage.setItem("queue",JSON.stringify(t.addOrRemoveFromQueue))}}),i=Object(o.a)(a,1)[0],r=e.thumbnail,c=e.artist,s=e.title;return Object(b.jsxs)("div",{className:n.container,children:[Object(b.jsx)(st.a,{src:r,alt:"Song thumbnail",className:n.avatar}),Object(b.jsxs)("div",{className:n.songInfoContainer,children:[Object(b.jsx)(d.a,{variant:"subtitle2",className:n.text,children:s}),Object(b.jsx)(d.a,{color:"textSecondary",variant:"body2",className:n.text,children:c})]}),Object(b.jsx)(X.a,{onClick:function(){i({variables:{input:Object(y.a)(Object(y.a)({},e),{},{__typename:"Song"})}})},children:Object(b.jsx)(lt.a,{color:"error"})})]})}var jt,bt=function(t){var e=t.queue;return Object(ot.a)((function(t){return t.breakpoints.up("md")}))&&Object(b.jsxs)("div",{style:{margin:"10px 0"},children:[Object(b.jsxs)(d.a,{color:"textSecondary",variant:"button",children:["QUEUE (",e.length,")"]}),e.map((function(t){return Object(b.jsx)(dt,{song:t},t.id)}))]})},pt=n(245),Ot=n(229),ht=n(230),gt=n(242),mt=Object(D.a)(jt||(jt=Object(R.a)(["\n\tquery getQueuedSongs {\n\t\tqueue @client {\n\t\t\tid\n\t\t\tduration\n\t\t\ttitle\n\t\t\tartist\n\t\t\tthumbnail\n\t\t\turl\n\t\t}\n\t}\n"]))),xt=Object(s.a)((function(t){return{container:{display:"flex",justifyContent:"space-between"},details:{display:"flex",flexDirection:"column",padding:"0px 15px"},content:{flex:"1 0 auto"},thumbnail:{width:150},controls:{display:"flex",alignItems:"center",paddingLeft:t.spacing(1),paddingRight:t.spacing(1)},playIcon:{height:38,width:38}}}));var ft=function(){var t,e=Object(gt.a)(mt).data,n=i.a.useRef(),a=i.a.useContext(wt),r=a.state,c=a.dispatch,s=i.a.useState(0),l=Object(o.a)(s,2),u=l[0],j=l[1],p=i.a.useState(0),O=Object(o.a)(p,2),h=O[0],g=O[1],m=i.a.useState(!1),x=Object(o.a)(m,2),f=x[0],v=x[1],y=i.a.useState(0),S=Object(o.a)(y,2),w=S[0],N=S[1],C=xt();return i.a.useEffect((function(){var t=e.queue.findIndex((function(t){return t.id===r.song.id}));N(t)}),[e.queue,r.song.id]),i.a.useEffect((function(){var t=e.queue[w+1];u>=.99&&t&&(j(0),c({type:"SET_SONG",payload:{song:t}}))}),[e.queue,u,c,w]),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)(z.a,{variant:"outlined",className:C.container,children:[Object(b.jsxs)("div",{className:C.details,children:[Object(b.jsxs)(V.a,{className:C.content,children:[Object(b.jsx)(d.a,{variant:"h5",component:"h3",children:r.song.title}),Object(b.jsx)(d.a,{variant:"subtitle1",component:"p",color:"textSecondary",children:r.song.artist})]}),Object(b.jsxs)("div",{className:C.controls,children:[Object(b.jsx)(X.a,{onClick:function(){var t=e.queue[w-1];t&&c({type:"SET_SONG",payload:{song:t}})},children:Object(b.jsx)(Ot.a,{})}),Object(b.jsx)(X.a,{onClick:function(){c(r.isPlaying?{type:"PAUSE_SONG"}:{type:"PLAY_SONG"})},children:r.isPlaying?Object(b.jsx)(Z.a,{className:C.playIcon}):Object(b.jsx)(tt.a,{className:C.playIcon})}),Object(b.jsx)(X.a,{onClick:function(){var t=e.queue[w+1];t&&c({type:"SET_SONG",payload:{song:t}})},children:Object(b.jsx)(ht.a,{})}),Object(b.jsx)(d.a,{variant:"subtitle1",component:"p",color:"textSecondary",children:(t=h,new Date(1e3*t).toISOString().substr(11,8))})]}),Object(b.jsx)(pt.a,{onMouseDown:function(){v(!0)},onMouseUp:function(){v(!1),n.current.seekTo(u)},onChange:function(t,e){j(e)},value:u,type:"range",min:0,max:1,step:.01})]}),Object(b.jsx)(A.a,{ref:n,onProgress:function(t){var e=t.played,n=t.playedSeconds;f||(j(e),g(n))},url:r.song.url,playing:r.isPlaying,hidden:!0}),Object(b.jsx)(K.a,{className:C.thumbnail,image:r.song.thumbnail})]}),Object(b.jsx)(bt,{queue:e.queue})]})},vt=n(241),yt=n(231);var St=function(t,e){switch(e.type){case"PLAY_SONG":return Object(y.a)(Object(y.a)({},t),{},{isPlaying:!0});case"PAUSE_SONG":return Object(y.a)(Object(y.a)({},t),{},{isPlaying:!1});case"SET_SONG":return Object(y.a)(Object(y.a)({},t),{},{song:e.payload.song});default:return t}},wt=i.a.createContext({song:{id:"bef8a1ca-6db1-4f44-b47c-8da14c12b508",title:"A Way Home",artist:"Memorex Memories",thumbnail:"http://img.youtube.com/vi/KbC46oJmLh4/0.jpg",url:"https://www.youtube.com/watch?v=KbC46oJmLh4",duration:239},isPlaying:!1});var Nt,Ct=function(){var t=i.a.useContext(wt),e=i.a.useReducer(St,t),n=Object(o.a)(e,2),a=n[0],r=n[1],c=Object(ot.a)((function(t){return t.breakpoints.up("sm")})),s=Object(ot.a)((function(t){return t.breakpoints.up("md")}));return Object(b.jsxs)(wt.Provider,{value:{state:a,dispatch:r},children:[Object(b.jsx)(vt.a,{only:"xs",children:Object(b.jsx)(g,{})}),Object(b.jsxs)(yt.a,{container:!0,spacing:3,children:[Object(b.jsxs)(yt.a,{style:{paddingTop:c?80:10},item:!0,xs:12,md:7,children:[Object(b.jsx)(W,{}),Object(b.jsx)(ct,{})]}),Object(b.jsx)(yt.a,{style:s?{position:"fixed",width:"100%",right:0,top:70}:{position:"fixed",width:"100%",left:0,bottom:0},item:!0,xs:12,md:5,children:Object(b.jsx)(ft,{})})]})]})},It=n(235),kt=n(236),qt=n(234),Pt=n(118),_t=n(232),Et=n(233),At=Object(Pt.a)({palette:{type:"dark",primary:_t.a,secondary:Et.a}}),Ft=n(119),Tt=n(116),Gt=n(121),Qt=n(120),$t=new Tt.a({link:new Gt.a({uri:"wss://apollo-music-share-hashim-k.herokuapp.com/v1/graphql",options:{reconnect:!0}}),cache:new Qt.a,typeDefs:Object(D.a)(Nt||(Nt=Object(R.a)(["\n\t\ttype Song {\n\t\t\tid: uuid!\n\t\t\ttitle: String!\n\t\t\tartist: String!\n\t\t\tthumbnail: String!\n\t\t\tduration: Float!\n\t\t\turl: String!\n\t\t}\n\n\t\tinput SongInput {\n\t\t\tid: uuid!\n\t\t\ttitle: String!\n\t\t\tartist: String!\n\t\t\tthumbnail: String!\n\t\t\tduration: Float!\n\t\t\turl: String!\n\t\t}\n\n\t\ttype Query {\n\t\t\tqueue: [Song]!\n\t\t}\n\n\t\ttype Mutation {\n\t\t\taddOrRemoveFromQueue(input: SongInput!): [Song]!\n\t\t}\n\t"]))),resolvers:{Mutation:{addOrRemoveFromQueue:function(t,e,n){var a=e.input,i=n.cache,r=i.readQuery({query:mt});if(r){var c=r.queue,o=c.some((function(t){return t.id===a.id}))?c.filter((function(t){return t.id!==a.id})):[].concat(Object(Ft.a)(c),[a]);return i.writeQuery({query:mt,data:{queue:o}}),o}return[]}}}}),Rt={queue:Boolean(localStorage.getItem("queue"))?JSON.parse(localStorage.getItem("queue")):[]};$t.writeData({data:Rt});var Dt=$t;c.a.render(Object(b.jsx)(qt.a,{client:Dt,children:Object(b.jsxs)(It.a,{theme:At,children:[Object(b.jsx)(kt.a,{}),Object(b.jsx)(Ct,{})]})}),document.getElementById("root"))}},[[169,1,2]]]);
//# sourceMappingURL=main.5d8c3505.chunk.js.map